generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Job represents a clip generation request
model Job {
  id           String    @id @default(uuid())
  youtubeUrl   String
  prompt       String
  jobType      JobType   @default(CLIP) // CLIP = extract clips, GENERATE = AI generate
  status       JobStatus @default(PENDING)
  progress     Int       @default(0) // Progress percentage (0-100)
  errorMessage String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  // Relations
  clips Clip[]

  @@map("jobs")
}

// Clip represents a generated video clip
model Clip {
  id        String   @id @default(uuid())
  jobId     String
  title     String?
  startTime Float    // Start time in seconds
  endTime   Float    // End time in seconds
  duration  Float    // Duration in seconds
  url       String?  // S3/R2 URL after upload
  createdAt DateTime @default(now())

  // Relations
  job Job @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@map("clips")
}

enum JobType {
  CLIP      // Extract clips from long video
  GENERATE  // AI generate new video
}

enum JobStatus {
  PENDING
  DOWNLOADING
  TRANSCRIBING
  ANALYZING
  CLIPPING
  GENERATING  // New: AI video generation
  UPLOADING
  COMPLETED
  FAILED
}
